<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiji Local Link (Public)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'fiji-blue': '#0A7AF1',
                        'fiji-gold': '#FFD700',
                        'fiji-coral': '#F2745A',
                        'neutral-light': '#F8F9FA',
                        'neutral-dark': '#343A40',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA;
        }
        /* Custom scrollbar for touch devices */
        .overflow-y-scroll::-webkit-scrollbar {
            width: 4px;
        }
        .overflow-y-scroll::-webkit-scrollbar-thumb {
            background-color: #CCC;
            border-radius: 2px;
        }
        /* Style for the floating action button */
        .fab {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .fab:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>

<body class="min-h-screen flex flex-col antialiased">

    <!-- Global App State -->
    <script>
        // Global state is defined here. Since we removed Firebase, we use local state.
        const app = {
            // Data and state variables
            services: [],
            categories: ['All Services', 'Trades', 'Food', 'Health', 'Other'],
            currentCategory: 'All Services',
            isAuthReady: true, // Always true for the public version
            userId: 'PUBLIC_DEMO_USER', // Hardcoded for display purposes
            isLoading: false,

            // DOM elements
            loader: null,
            contentArea: null,
            userIdSpan: null,
            categoryTabs: null,
            serviceList: null,
            addServiceButton: null,
            submitServiceButton: null,
            modal: null,
            alertModal: null,

            // Core App Methods
            initApp: function() {
                this.cacheDOMElements();
                this.renderTabs();
                this.attachEventListeners();
                this.updateUI();

                // Start the demo/public flow
                this.simulateLoading();
                console.log("Public Demo Mode: Firebase disabled.");
            },

            simulateLoading: function() {
                this.isLoading = true;
                this.updateUI();
                setTimeout(() => {
                    this.isLoading = false;
                    this.updateUI();
                    this.loadDemoServices();
                }, 1000);
            },

            loadDemoServices: function() {
                // Dummy data for public view since Firebase is disabled
                this.services = [
                    { id: '1', name: 'Ratu Electrical', category: 'Trades', description: '24/7 emergency electrical services. Licensed and certified.', userId: 'user-a', location: 'Suva' },
                    { id: '2', name: 'Fresh Bites Cafe', category: 'Food', description: 'Best Lovo and traditional Fijian food. Catering available.', userId: 'user-b', location: 'Nadi' },
                    { id: '3', name: 'Island Plumbing', category: 'Trades', description: 'Residential and commercial plumbing repairs. Call for a quote.', userId: 'user-c', location: 'Lautoka' },
                    { id: '4', name: 'Dental Health Fiji', category: 'Health', description: 'Routine checkups and emergency dental care. Modern equipment.', userId: 'user-d', location: 'Suva' },
                    { id: '5', name: 'Mobile Tyre Repair', category: 'Other', description: 'Flat tyre repair at your location, any time of day.', userId: 'user-e', location: 'Nadi' },
                ];
                this.updateServiceList();
            },
            
            // Utility Methods
            cacheDOMElements: function() {
                this.loader = document.getElementById('loading-indicator');
                this.contentArea = document.getElementById('content-area');
                this.userIdSpan = document.getElementById('user-id-display');
                this.categoryTabs = document.getElementById('category-tabs');
                this.serviceList = document.getElementById('service-list');
                this.addServiceButton = document.getElementById('add-service-button');
                this.modal = document.getElementById('add-service-modal');
                this.submitServiceButton = document.getElementById('submit-service-btn');
                this.alertModal = document.getElementById('custom-alert');
            },

            attachEventListeners: function() {
                this.categoryTabs.addEventListener('click', (e) => this.handleTabClick(e));
                this.addServiceButton.addEventListener('click', () => this.showModal('add-service-modal'));
                this.submitServiceButton.addEventListener('click', (e) => this.handleSubmit(e));
                document.getElementById('close-modal-btn').addEventListener('click', () => this.closeModal('add-service-modal'));
            },

            handleTabClick: function(e) {
                const target = e.target.closest('.tab-item');
                if (target) {
                    this.currentCategory = target.dataset.category;
                    this.renderTabs();
                    this.updateServiceList();
                }
            },

            updateUI: function() {
                this.userIdSpan.textContent = this.isAuthReady ? this.userId : 'Loading...';
                if (this.isLoading) {
                    this.loader.classList.remove('hidden');
                    this.contentArea.classList.add('hidden');
                } else {
                    this.loader.classList.add('hidden');
                    this.contentArea.classList.remove('hidden');
                }
                this.renderTabs();
            },

            renderTabs: function() {
                this.categoryTabs.innerHTML = this.categories.map(category => {
                    const isActive = category === this.currentCategory;
                    return `
                        <button data-category="${category}" class="tab-item px-4 py-2 text-sm font-semibold rounded-full transition-all duration-200 
                            ${isActive ? 'bg-fiji-blue text-white shadow-md' : 'text-neutral-dark hover:bg-neutral-light'}">
                            ${category}
                        </button>
                    `;
                }).join('');
            },

            updateServiceList: function() {
                const filteredServices = this.currentCategory === 'All Services'
                    ? this.services
                    : this.services.filter(s => s.category === this.currentCategory);

                this.serviceList.innerHTML = filteredServices.map(service => `
                    <div class="bg-white p-4 rounded-xl shadow-lg border-l-4 border-fiji-blue flex flex-col space-y-2 mb-4">
                        <div class="flex justify-between items-start">
                            <h3 class="text-xl font-bold text-fiji-blue">${service.name}</h3>
                            <span class="text-xs font-medium text-white px-3 py-1 bg-fiji-coral rounded-full">${service.category}</span>
                        </div>
                        <p class="text-sm text-neutral-dark">${service.description}</p>
                        <div class="flex justify-between items-center pt-2 border-t border-neutral-light">
                            <span class="text-xs text-neutral-dark">Listed by: ${service.userId}</span>
                            <span class="text-sm font-semibold text-fiji-blue">${service.location || 'Fiji Wide'}</span>
                        </div>
                    </div>
                `).join('');

                if (filteredServices.length === 0) {
                    this.serviceList.innerHTML = `
                        <div class="text-center p-8 bg-neutral-light rounded-xl shadow-inner">
                            <p class="text-lg font-semibold text-neutral-dark">No services found in this category.</p>
                            <p class="text-sm text-gray-500">Be the first to list a service in this category!</p>
                        </div>
                    `;
                }
            },

            // Modal Handlers
            showModal: function(id) {
                const targetModal = document.getElementById(id);
                targetModal.classList.remove('hidden');
                setTimeout(() => targetModal.querySelector('.modal-content').classList.remove('translate-y-full'), 10);
            },

            closeModal: function(id) {
                const targetModal = document.getElementById(id);
                targetModal.querySelector('.modal-content').classList.add('translate-y-full');
                setTimeout(() => targetModal.classList.add('hidden'), 300);
            },
            
            // Form Submission (DUMMY)
            handleSubmit: function(e) {
                e.preventDefault();
                this.showCustomAlert('Error', 'Database features are disabled in this public demo version.', 'error');
                this.closeModal('add-service-modal');
            },

            // Custom Alert Modal (instead of alert())
            showCustomAlert: function(title, message, type) {
                const alertTitle = document.getElementById('alert-title');
                const alertMessage = document.getElementById('alert-message');
                const alertIcon = document.getElementById('alert-icon');
                const alertContent = this.alertModal.querySelector('.modal-content');

                alertTitle.textContent = title;
                alertMessage.textContent = message;

                // Set styling based on type
                alertIcon.innerHTML = type === 'error' ? '<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-fiji-coral" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.3 16c-.77 1.333.192 3 1.732 3z" /></svg>' : '<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-secondary-green" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';
                
                if (type === 'error') {
                    alertContent.classList.add('border-fiji-coral');
                    alertContent.classList.remove('border-fiji-blue');
                } else {
                    alertContent.classList.remove('border-fiji-coral');
                    alertContent.classList.add('border-fiji-blue');
                }

                this.showModal('custom-alert');

                // Attach event listener to close button
                document.getElementById('alert-ok-button').onclick = () => this.closeModal('custom-alert');
            },
        };

        // Initialize the app on window load
        window.onload = function () {
            app.initApp();
        };
    </script>

    <!-- Main Application Container -->
    <div class="container mx-auto p-4 md:p-6 flex-grow">

        <!-- Header Card -->
        <header class="bg-white p-6 rounded-3xl shadow-xl text-center mb-6">
            <h1 class="text-4xl font-extrabold text-fiji-blue">Fiji Local Link</h1>
            <p class="text-sm text-gray-500 mt-2">Connecting essential services in Fiji. (User ID: <span id="user-id-display" class="font-mono text-xs text-neutral-dark">Loading...</span>)</p>
        </header>

        <!-- Loading Indicator -->
        <div id="loading-indicator" class="text-center p-8 bg-white rounded-xl shadow-lg border-t border-fiji-blue">
            <p class="text-lg font-semibold text-neutral-dark">Connecting to Database...</p>
            <div class="mt-4 flex justify-center items-center">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-fiji-blue"></div>
            </div>
        </div>

        <!-- Content Area (Hidden until loaded) -->
        <div id="content-area" class="hidden">
            
            <!-- Category Tabs -->
            <div id="category-tabs" class="flex flex-wrap gap-2 mb-6 p-3 bg-white rounded-xl shadow-md overflow-x-auto whitespace-nowrap">
                <!-- Tabs rendered here by JavaScript -->
            </div>

            <!-- Service List -->
            <section id="service-list" class="space-y-4">
                <!-- Services loaded here by JavaScript -->
            </section>

        </div>
    </div>
    
    <!-- Floating Action Button (FAB) -->
    <button id="add-service-button" class="fab fixed bottom-8 right-8 w-14 h-14 bg-fiji-blue text-white rounded-full shadow-2xl flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
        </svg>
    </button>

    <!-- Add Service Modal -->
    <div id="add-service-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-end justify-center transition-opacity duration-300" onclick="if(event.target.id === 'add-service-modal') app.closeModal('add-service-modal')">
        <div class="modal-content transform transition-transform duration-300 translate-y-full w-full max-w-lg bg-white p-6 rounded-t-3xl shadow-2xl border-t-4 border-fiji-blue">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-fiji-blue">List Your Essential Service</h2>
                <button id="close-modal-btn" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <form id="service-form" class="space-y-4">
                <div>
                    <label for="service-name" class="block text-sm font-medium text-neutral-dark mb-1">Service Name/Business Title</label>
                    <input type="text" id="service-name" name="service-name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-fiji-blue focus:border-fiji-blue transition-colors" required>
                </div>
                
                <div>
                    <label for="category" class="block text-sm font-medium text-neutral-dark mb-1">Category</label>
                    <select id="category" name="category" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-fiji-blue focus:border-fiji-blue transition-colors" required>
                        <option value="Trades">Trades (Plumbing, Electrical, Carpentry)</option>
                        <option value="Food">Food (Restaurants, Catering, Delivery)</option>
                        <option value="Health">Health (Clinics, Pharmacy, Wellness)</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div>
                    <label for="service-description" class="block text-sm font-medium text-neutral-dark mb-1">Description / Contact Details</label>
                    <textarea id="service-description" name="service-description" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-fiji-blue focus:border-fiji-blue transition-colors" required></textarea>
                </div>
                
                <button id="submit-service-btn" type="submit" class="w-full py-3 bg-fiji-coral text-white font-bold rounded-lg shadow-md hover:bg-opacity-90 transition-opacity">
                    Submit Service
                </button>
                <p class="text-xs text-center text-gray-500 pt-2">Database submission is disabled in public demo.</p>
            </form>
        </div>
    </div>

    <!-- Custom Alert Modal -->
    <div id="custom-alert" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center transition-opacity duration-300" onclick="if(event.target.id === 'custom-alert') app.closeModal('custom-alert')">
        <div class="modal-content transform transition-transform duration-300 w-11/12 max-w-sm bg-white p-6 rounded-xl shadow-2xl border-t-4 border-fiji-coral">
            <div class="flex items-start space-x-4">
                <div id="alert-icon">
                    <!-- Icon placeholder -->
                </div>
                <div class="flex-grow">
                    <h3 id="alert-title" class="text-xl font-bold text-neutral-dark mb-2">Alert</h3>
                    <p id="alert-message" class="text-sm text-gray-700">Message content here.</p>
                </div>
            </div>
            <div class="mt-6 flex justify-end">
                <button id="alert-ok-button" class="px-6 py-2 bg-fiji-blue text-white font-semibold rounded-lg hover:bg-opacity-90 transition-opacity">
                    Understood
                </button>
            </div>
        </div>
    </div>
</body>
</html>

